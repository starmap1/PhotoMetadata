<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Metadata Extractor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 900px;
            width: 100%;
            padding: 40px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            text-align: center;
        }

        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .upload-section {
            margin-bottom: 30px;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type="file"] {
            display: none;
        }

        .upload-label {
            display: block;
            padding: 30px;
            border: 2px dashed #667eea;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            background: #f8f9ff;
            transition: all 0.3s ease;
        }

        .upload-label:hover {
            background: #e8ebff;
            border-color: #764ba2;
        }

        .upload-label.drag-over {
            background: #e8ebff;
            border-color: #764ba2;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .upload-label p {
            color: #667eea;
            font-weight: 600;
            margin: 5px 0;
        }

        .upload-label span {
            color: #999;
            font-size: 12px;
        }

        .preview-section {
            display: none;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #eee;
        }

        .preview-section.active {
            display: block;
        }

        .preview-image {
            max-width: 300px;
            max-height: 300px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .metadata-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        @media (max-width: 600px) {
            .metadata-container {
                grid-template-columns: 1fr;
            }
        }

        .metadata-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .metadata-card h3 {
            color: #667eea;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }

        .metadata-card p {
            color: #333;
            font-size: 16px;
            word-break: break-all;
        }

        .metadata-value {
            color: #764ba2;
            font-weight: 600;
        }

        .no-data {
            color: #999;
            font-style: italic;
            font-size: 14px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-weight: 600;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #fee;
            color: #c00;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #c00;
        }

        .success {
            background: #efe;
            color: #060;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #060;
        }

        .camera-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            grid-column: 1 / -1;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .camera-info-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .camera-info-item h4 {
            font-size: 11px;
            text-transform: uppercase;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .camera-info-item p {
            font-size: 16px;
            font-weight: 600;
        }

        .clear-btn {
            background: #999;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s ease;
            margin-top: 20px;
        }

        .clear-btn:hover {
            background: #666;
        }

        .metadata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .metadata-item {
            background: white;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #ddd;
        }

        .metadata-item strong {
            color: #667eea;
            display: block;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .metadata-item span {
            color: #333;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì∏ Photo Metadata Extractor</h1>
        <p class="subtitle">Upload a photo to extract detailed EXIF metadata including camera and lens information</p>

        <div class="upload-section">
            <div class="file-input-wrapper">
                <input 
                    type="file" 
                    id="imageInput" 
                    accept="image/*"
                >
                <label for="imageInput" class="upload-label" id="uploadLabel">
                    <div class="upload-icon">üì∑</div>
                    <p>Click to upload or drag and drop</p>
                    <span>PNG, JPG, GIF, WEBP, HEIC, TIFF, RAW formats supported</span>
                </label>
            </div>
        </div>

        <div id="loadingSection" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Extracting metadata...</p>
        </div>

        <div id="errorSection"></div>

        <div id="previewSection" class="preview-section">
            <img id="previewImage" class="preview-image" alt="Preview">
            
            <div id="metadataSection"></div>
            
            <button class="clear-btn" onclick="clearAll()">Upload Another Photo</button>
        </div>
    </div>

    <script src="https://unpkg.com/exifr"></script>
    <script>
        const imageInput = document.getElementById('imageInput');
        const uploadLabel = document.getElementById('uploadLabel');
        const loadingSection = document.getElementById('loadingSection');
        const errorSection = document.getElementById('errorSection');
        const previewSection = document.getElementById('previewSection');
        const previewImage = document.getElementById('previewImage');
        const metadataSection = document.getElementById('metadataSection');

        // Drag and drop functionality
        uploadLabel.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadLabel.classList.add('drag-over');
        });

        uploadLabel.addEventListener('dragleave', () => {
            uploadLabel.classList.remove('drag-over');
        });

        uploadLabel.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadLabel.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                imageInput.files = files;
                processImage();
            }
        });

        // File input change
        imageInput.addEventListener('change', processImage);

        async function processImage() {
            const file = imageInput.files[0];
            if (!file) return;

            // Show loading state
            loadingSection.style.display = 'block';
            errorSection.innerHTML = '';
            previewSection.classList.remove('active');

            try {
                // Display preview
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewImage.src = e.target.result;
                };
                reader.readAsDataURL(file);

                // Extract EXIF data
                const exifData = await exifr.parse(file, { mergeOutput: true });
                
                loadingSection.style.display = 'none';
                displayMetadata(exifData);
            } catch (error) {
                loadingSection.style.display = 'none';
                showError(`Error extracting metadata: ${error.message}`);
            }
        }

        function displayMetadata(exifData) {
            if (!exifData || Object.keys(exifData).length === 0) {
                showError('No EXIF metadata found in this image.');
                previewSection.classList.add('active');
                return;
            }

            let html = '';

            // Camera Information
            const cameraInfo = {
                Make: exifData.Make,
                Model: exifData.Model,
                Software: exifData.Software,
                DateTime: exifData.DateTime
            };

            // Lens Information
            const lensInfo = {
                LensMake: exifData.LensMake,
                LensModel: exifData.LensModel,
                LensSerialNumber: exifData.LensSerialNumber,
                LensSpecification: exifData.LensSpecification
            };

            // Shooting Settings
            const shootingSettings = {
                ExposureTime: exifData.ExposureTime ? `1/${Math.round(1/exifData.ExposureTime)}s` : 'N/A',
                FNumber: exifData.FNumber ? `f/${exifData.FNumber}` : 'N/A',
                ISOSpeedRatings: exifData.ISOSpeedRatings || exifData.ISO || 'N/A',
                FocalLength: exifData.FocalLength ? `${exifData.FocalLength}mm` : 'N/A',
                FocalLengthIn35mmFilm: exifData.FocalLengthIn35mmFilm ? `${exifData.FocalLengthIn35mmFilm}mm` : 'N/A',
                MaxAperture: exifData.MaxAperture ? `f/${exifData.MaxAperture}` : 'N/A'
            };

<!--            // Image Information-->
<!--            const imageInfo = {-->
<!--                ImageWidth: exifData.ImageWidth ? `${exifData.ImageWidth}px` : 'N/A',-->
<!--                ImageHeight: exifData.ImageHeight ? `${exifData.ImageHeight}px` : 'N/A',-->
<!--                ColorSpace: exifData.ColorSpace || 'N/A',-->
<!--                Orientation: getOrientationText(exifData.Orientation),-->
<!--                ResolutionUnit: exifData.ResolutionUnit || 'N/A',-->
<!--                XResolution: exifData.XResolution ? `${exifData.XResolution} dpi` : 'N/A',-->
<!--                YResolution: exifData.YResolution ? `${exifData.YResolution} dpi` : 'N/A'-->
<!--            };-->

<!--            // Exposure Information-->
<!--            const exposureInfo = {-->
<!--                ExposureMode: getExposureMode(exifData.ExposureMode),-->
<!--                ExposureProgram: getExposureProgram(exifData.ExposureProgram),-->
<!--                Flash: getFlashText(exifData.Flash),-->
<!--                WhiteBalance: getWhiteBalance(exifData.WhiteBalance),-->
<!--                MeteringMode: getMeteringMode(exifData.MeteringMode),-->
<!--                Brightness: exifData.BrightnessValue ? exifData.BrightnessValue.toFixed(2) : 'N/A',-->
<!--                LightSource: getLightSource(exifData.LightSource)-->
<!--            };-->

<!--            // GPS Information-->
<!--            const gpsInfo = exifData.latitude && exifData.longitude ? {-->
<!--                Latitude: `${Math.abs(exifData.latitude).toFixed(6)}¬∞ ${exifData.latitude > 0 ? 'N' : 'S'}`,-->
<!--                Longitude: `${Math.abs(exifData.longitude).toFixed(6)}¬∞ ${exifData.longitude > 0 ? 'E' : 'W'}`,-->
<!--                Altitude: exifData.altitude ? `${exifData.altitude.toFixed(2)}m` : 'N/A',-->
<!--                GPSDateStamp: exifData.GPSDateStamp || 'N/A'-->
<!--            } : null;-->

            // Build HTML
            html += buildCameraSection(cameraInfo);
            html += buildLensSection(lensInfo);
            html += buildMetadataSection('Shooting Settings', shootingSettings);
<!--            html += buildMetadataSection('Image Information', imageInfo);-->
<!--            html += buildMetadataSection('Exposure Information', exposureInfo);-->
            
<!--            if (gpsInfo) {-->
<!--                html += buildMetadataSection('GPS Information', gpsInfo);-->
<!--            }-->

            metadataSection.innerHTML = html;
            previewSection.classList.add('active');
        }

        function buildCameraSection(info) {
            const hasCamera = Object.values(info).some(v => v);
            if (!hasCamera) return '';

            return `
                <div class="camera-info">
                    <div class="camera-info-item">
                        <h4>Camera Make</h4>
                        <p>${info.Make || 'Unknown'}</p>
                    </div>
                    <div class="camera-info-item">
                        <h4>Camera Model</h4>
                        <p>${info.Model || 'Unknown'}</p>
                    </div>
                    <div class="camera-info-item">
                        <h4>Date Taken</h4>
                        <p>${formatDate(info.DateTime) || 'Unknown'}</p>
                    </div>
                    <div class="camera-info-item">
                        <h4>Software</h4>
                        <p>${info.Software || 'Unknown'}</p>
                    </div>
                </div>
            `;
        }

        function buildLensSection(info) {
            const hasLens = Object.values(info).some(v => v);
            if (!hasLens) return '';

            let lensSpec = 'N/A';
            if (info.LensSpecification) {
                if (Array.isArray(info.LensSpecification)) {
                    lensSpec = `${info.LensSpecification[0]}-${info.LensSpecification[1]}mm`;
                } else {
                    lensSpec = info.LensSpecification;
                }
            }

            return `
                <div class="metadata-container" style="margin-top: 30px;">
                    <div class="metadata-card" style="border-left-color: #e74c3c; grid-column: 1 / -1;">
                        <h3>üîç Lens Information</h3>
                        <div class="metadata-grid">
                            <div class="metadata-item">
                                <strong>Lens Make</strong>
                                <span>${info.LensMake || 'Unknown'}</span>
                            </div>
                            <div class="metadata-item">
                                <strong>Lens Model</strong>
                                <span>${info.LensModel || 'Unknown'}</span>
                            </div>
                            <div class="metadata-item">
                                <strong>Lens Specification</strong>
                                <span>${lensSpec}</span>
                            </div>
                            <div class="metadata-item">
                                <strong>Serial Number</strong>
                                <span>${info.LensSerialNumber || 'Unknown'}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function buildMetadataSection(title, data) {
            const hasData = Object.values(data).some(v => v !== 'N/A');
            if (!hasData) return '';

            let html = `<div class="metadata-container">`;
            
            if (title === 'Image Information' || title === 'Exposure Information' || title === 'GPS Information') {
                html += `<div class="metadata-card" style="grid-column: 1 / -1;"><h3>${title}</h3><div class="metadata-grid">`;
            } else {
                html += `<div class="metadata-card" style="grid-column: 1 / -1;"><h3>${title}</h3><div class="metadata-grid">`;
            }

            for (const [key, value] of Object.entries(data)) {
                const displayKey = key.replace(/([A-Z])/g, ' $1').trim();
                html += `
                    <div class="metadata-item">
                        <strong>${displayKey}</strong>
                        <span>${value || 'N/A'}</span>
                    </div>
                `;
            }

            html += `</div></div></div>`;
            return html;
        }

        function showError(message) {
            errorSection.innerHTML = `<div class="error">‚ö†Ô∏è ${message}</div>`;
        }

        function clearAll() {
            imageInput.value = '';
            previewSection.classList.remove('active');
            errorSection.innerHTML = '';
            loadingSection.style.display = 'none';
        }

        // Helper functions for readable values
        function formatDate(dateStr) {
            if (!dateStr) return null;
            try {
                const date = new Date(dateStr.replace(/[:\-]/g, '/'));
                return date.toLocaleString();
            } catch {
                return dateStr;
            }
        }

        function getOrientationText(orientation) {
            const orientations = {
                1: 'Normal',
                2: 'Flipped Horizontally',
                3: 'Rotated 180¬∞',
                4: 'Flipped Vertically',
                5: 'Transposed',
                6: 'Rotated 90¬∞ CW',
                7: 'Transversed',
                8: 'Rotated 270¬∞ CW'
            };
            return orientations[orientation] || 'Unknown';
        }

        function getExposureMode(mode) {
            const modes = { 0: 'Auto', 1: 'Manual', 2: 'Auto Bracket' };
            return modes[mode] || 'Unknown';
        }

        function getExposureProgram(program) {
            const programs = {
                0: 'Not Defined',
                1: 'Manual',
                2: 'Normal Program',
                3: 'Aperture Priority',
                4: 'Shutter Priority',
                5: 'Creative Program',
                6: 'Action Program',
                7: 'Portrait Mode',
                8: 'Landscape Mode'
            };
            return programs[program] || 'Unknown';
        }

        function getFlashText(flash) {
            if (flash === undefined) return 'Not Recorded';
            return flash ? 'Flash Fired' : 'Flash Did Not Fire';
        }

        function getWhiteBalance(wb) {
            const wb_modes = { 0: 'Auto', 1: 'Manual' };
            return wb_modes[wb] || 'Unknown';
        }

        function getMeteringMode(mode) {
            const modes = {
                0: 'Unknown',
                1: 'Average',
                2: 'Center-weighted Average',
                3: 'Spot',
                4: 'Multi-segment',
                5: 'Pattern',
                6: 'Partial'
            };
            return modes[mode] || 'Unknown';
        }

        function getLightSource(source) {
            const sources = {
                0: 'Unknown',
                1: 'Daylight',
                2: 'Fluorescent',
                3: 'Tungsten',
                4: 'Flash',
                9: 'Fine weather',
                10: 'Cloudy weather',
                11: 'Shade',
                12: 'Daylight fluorescent',
                13: 'Day white fluorescent',
                14: 'Cool white fluorescent',
                15: 'White fluorescent',
                17: 'Standard light A',
                18: 'Standard light B',
                19: 'Standard light C',
                20: 'D55',
                21: 'D65',
                22: 'D75',
                23: 'D50',
                24: 'ISO studio tungsten'
            };
            return sources[source] || 'Unknown';
        }
    </script>
</body>
</html>